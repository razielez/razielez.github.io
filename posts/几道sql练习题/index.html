<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>SQL练习题 | Razielez's Blog</title><meta name=keywords content="SQL"><meta name=description content="闲着没事情做几道SQL题。 Orcal SQL: 在线SQL测试
MySQL指定进入某个端口命令
mysql -uroot -p -P 3307 问题描述 1.学生表 Student(SID,Sname,Sage,Ssex) &ndash;SID 学生编号,Sname 学生姓名,Sage 出生年月,Ssex 学生性别. 2.课程表 Course(CID,Cname,TID) &ndash;CID &ndash;课程编号,Cname 课程名称,TID 教师编号. 3.教师表 Teacher(TID,Tname) &ndash;TID 教师编号,Tname 教师姓名. 4.成绩表 SC(SID,CID,score) &ndash;SID 学生编号,CID 课程编号,score 分数. 建表语句:
create table Student(SID varchar(10),Sname nvarchar(10),Sage datetime,Ssex nvarchar(10)); insert into Student values('01' , '赵雷' , '1990-01-01' , '男'); insert into Student values('02' , '钱电' , '1990-12-21' , '男'); insert into Student values('03' , '孙风' , '1990-05-20' , '男'); insert into Student values('04' , '李云' , '1990-08-06' , '男'); insert into Student values('05' , '周梅' , '1991-12-01' , '女'); insert into Student values('06' , '吴兰' , '1992-03-01' , '女'); insert into Student values('07' , '郑竹' , '1989-07-01' , '女'); insert into Student values('08' , '王菊' , '1990-01-20' , '女'); create table Course(CID varchar(10),Cname nvarchar(10),TID varchar(10)); insert into Course values('01' , '语文' , '02'); insert into Course values('02' , '数学' , '01'); insert into Course values('03' , '英语' , '03'); create table Teacher(TID varchar(10),Tname nvarchar(10)); insert into Teacher values('01' , '张三'); insert into Teacher values('02' , '李四'); insert into Teacher values('03' , '王五'); create table SC(SID varchar(10),CID varchar(10),score decimal(18,1)); insert into SC values('01' , '01' , 80); insert into SC values('01' , '02' , 90); insert into SC values('01' , '03' , 99); insert into SC values('02' , '01' , 70); insert into SC values('02' , '02' , 60); insert into SC values('02' , '03' , 80); insert into SC values('03' , '01' , 80); insert into SC values('03' , '02' , 80); insert into SC values('03' , '03' , 80); insert into SC values('04' , '01' , 50); insert into SC values('04' , '02' , 30); insert into SC values('04' , '03' , 20); insert into SC values('05' , '01' , 76); insert into SC values('05' , '02' , 87); insert into SC values('06' , '01' , 31); insert into SC values('06' , '03' , 34); insert into SC values('07' , '02' , 89); insert into SC values('07' , '03' , 98); 题目  查询&#34;01&#34;课程比&#34;02&#34;课程成绩高的学生的信息及课程分数   查询同时存在&#34;01&#34;课程和&#34;02&#34;课程的情况 结果:  +------+-------+---------------------+------+------------+------------+ | SID | Sname | Sage | Ssex | 01课程分数 | 02课程分数 | +------+-------+---------------------+------+------------+------------+ | 02 | 钱电 | 1990-12-21 00:00:00 | 男 | 70."><meta name=author content><link rel=canonical href=https://razielez.github.io/posts/%E5%87%A0%E9%81%93sql%E7%BB%83%E4%B9%A0%E9%A2%98/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.fef89dbd8fd8ffe465fea8fb5995a422e1060f64e336bb02afa6c128bd5f0c32.css integrity="sha256-/vidvY/Y/+Rl/qj7WZWkIuEGD2TjNrsCr6bBKL1fDDI=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://razielez.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://razielez.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://razielez.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://razielez.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://razielez.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-123-45','auto'),ga('send','pageview'))</script><meta property="og:title" content="SQL练习题"><meta property="og:description" content="闲着没事情做几道SQL题。 Orcal SQL: 在线SQL测试
MySQL指定进入某个端口命令
mysql -uroot -p -P 3307 问题描述 1.学生表 Student(SID,Sname,Sage,Ssex) &ndash;SID 学生编号,Sname 学生姓名,Sage 出生年月,Ssex 学生性别. 2.课程表 Course(CID,Cname,TID) &ndash;CID &ndash;课程编号,Cname 课程名称,TID 教师编号. 3.教师表 Teacher(TID,Tname) &ndash;TID 教师编号,Tname 教师姓名. 4.成绩表 SC(SID,CID,score) &ndash;SID 学生编号,CID 课程编号,score 分数. 建表语句:
create table Student(SID varchar(10),Sname nvarchar(10),Sage datetime,Ssex nvarchar(10)); insert into Student values('01' , '赵雷' , '1990-01-01' , '男'); insert into Student values('02' , '钱电' , '1990-12-21' , '男'); insert into Student values('03' , '孙风' , '1990-05-20' , '男'); insert into Student values('04' , '李云' , '1990-08-06' , '男'); insert into Student values('05' , '周梅' , '1991-12-01' , '女'); insert into Student values('06' , '吴兰' , '1992-03-01' , '女'); insert into Student values('07' , '郑竹' , '1989-07-01' , '女'); insert into Student values('08' , '王菊' , '1990-01-20' , '女'); create table Course(CID varchar(10),Cname nvarchar(10),TID varchar(10)); insert into Course values('01' , '语文' , '02'); insert into Course values('02' , '数学' , '01'); insert into Course values('03' , '英语' , '03'); create table Teacher(TID varchar(10),Tname nvarchar(10)); insert into Teacher values('01' , '张三'); insert into Teacher values('02' , '李四'); insert into Teacher values('03' , '王五'); create table SC(SID varchar(10),CID varchar(10),score decimal(18,1)); insert into SC values('01' , '01' , 80); insert into SC values('01' , '02' , 90); insert into SC values('01' , '03' , 99); insert into SC values('02' , '01' , 70); insert into SC values('02' , '02' , 60); insert into SC values('02' , '03' , 80); insert into SC values('03' , '01' , 80); insert into SC values('03' , '02' , 80); insert into SC values('03' , '03' , 80); insert into SC values('04' , '01' , 50); insert into SC values('04' , '02' , 30); insert into SC values('04' , '03' , 20); insert into SC values('05' , '01' , 76); insert into SC values('05' , '02' , 87); insert into SC values('06' , '01' , 31); insert into SC values('06' , '03' , 34); insert into SC values('07' , '02' , 89); insert into SC values('07' , '03' , 98); 题目  查询&#34;01&#34;课程比&#34;02&#34;课程成绩高的学生的信息及课程分数   查询同时存在&#34;01&#34;课程和&#34;02&#34;课程的情况 结果:  +------+-------+---------------------+------+------------+------------+ | SID | Sname | Sage | Ssex | 01课程分数 | 02课程分数 | +------+-------+---------------------+------+------------+------------+ | 02 | 钱电 | 1990-12-21 00:00:00 | 男 | 70."><meta property="og:type" content="article"><meta property="og:url" content="https://razielez.github.io/posts/%E5%87%A0%E9%81%93sql%E7%BB%83%E4%B9%A0%E9%A2%98/"><meta property="og:image" content="https://razielez.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-10-15T23:15:47+00:00"><meta property="article:modified_time" content="2019-10-15T23:15:47+00:00"><meta property="og:site_name" content="Razielez's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://razielez.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="SQL练习题"><meta name=twitter:description content="闲着没事情做几道SQL题。 Orcal SQL: 在线SQL测试
MySQL指定进入某个端口命令
mysql -uroot -p -P 3307 问题描述 1.学生表 Student(SID,Sname,Sage,Ssex) &ndash;SID 学生编号,Sname 学生姓名,Sage 出生年月,Ssex 学生性别. 2.课程表 Course(CID,Cname,TID) &ndash;CID &ndash;课程编号,Cname 课程名称,TID 教师编号. 3.教师表 Teacher(TID,Tname) &ndash;TID 教师编号,Tname 教师姓名. 4.成绩表 SC(SID,CID,score) &ndash;SID 学生编号,CID 课程编号,score 分数. 建表语句:
create table Student(SID varchar(10),Sname nvarchar(10),Sage datetime,Ssex nvarchar(10)); insert into Student values('01' , '赵雷' , '1990-01-01' , '男'); insert into Student values('02' , '钱电' , '1990-12-21' , '男'); insert into Student values('03' , '孙风' , '1990-05-20' , '男'); insert into Student values('04' , '李云' , '1990-08-06' , '男'); insert into Student values('05' , '周梅' , '1991-12-01' , '女'); insert into Student values('06' , '吴兰' , '1992-03-01' , '女'); insert into Student values('07' , '郑竹' , '1989-07-01' , '女'); insert into Student values('08' , '王菊' , '1990-01-20' , '女'); create table Course(CID varchar(10),Cname nvarchar(10),TID varchar(10)); insert into Course values('01' , '语文' , '02'); insert into Course values('02' , '数学' , '01'); insert into Course values('03' , '英语' , '03'); create table Teacher(TID varchar(10),Tname nvarchar(10)); insert into Teacher values('01' , '张三'); insert into Teacher values('02' , '李四'); insert into Teacher values('03' , '王五'); create table SC(SID varchar(10),CID varchar(10),score decimal(18,1)); insert into SC values('01' , '01' , 80); insert into SC values('01' , '02' , 90); insert into SC values('01' , '03' , 99); insert into SC values('02' , '01' , 70); insert into SC values('02' , '02' , 60); insert into SC values('02' , '03' , 80); insert into SC values('03' , '01' , 80); insert into SC values('03' , '02' , 80); insert into SC values('03' , '03' , 80); insert into SC values('04' , '01' , 50); insert into SC values('04' , '02' , 30); insert into SC values('04' , '03' , 20); insert into SC values('05' , '01' , 76); insert into SC values('05' , '02' , 87); insert into SC values('06' , '01' , 31); insert into SC values('06' , '03' , 34); insert into SC values('07' , '02' , 89); insert into SC values('07' , '03' , 98); 题目  查询&#34;01&#34;课程比&#34;02&#34;课程成绩高的学生的信息及课程分数   查询同时存在&#34;01&#34;课程和&#34;02&#34;课程的情况 结果:  +------+-------+---------------------+------+------------+------------+ | SID | Sname | Sage | Ssex | 01课程分数 | 02课程分数 | +------+-------+---------------------+------+------------+------------+ | 02 | 钱电 | 1990-12-21 00:00:00 | 男 | 70."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://razielez.github.io/posts/"},{"@type":"ListItem","position":3,"name":"SQL练习题","item":"https://razielez.github.io/posts/%E5%87%A0%E9%81%93sql%E7%BB%83%E4%B9%A0%E9%A2%98/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"SQL练习题","name":"SQL练习题","description":"闲着没事情做几道SQL题。 Orcal SQL: 在线SQL测试\nMySQL指定进入某个端口命令\nmysql -uroot -p -P 3307 问题描述 1.学生表 Student(SID,Sname,Sage,Ssex) \u0026ndash;SID 学生编号,Sname 学生姓名,Sage 出生年月,Ssex 学生性别. 2.课程表 Course(CID,Cname,TID) \u0026ndash;CID \u0026ndash;课程编号,Cname 课程名称,TID 教师编号. 3.教师表 Teacher(TID,Tname) \u0026ndash;TID 教师编号,Tname 教师姓名. 4.成绩表 SC(SID,CID,score) \u0026ndash;SID 学生编号,CID 课程编号,score 分数. 建表语句:\ncreate table Student(SID varchar(10),Sname nvarchar(10),Sage datetime,Ssex nvarchar(10)); insert into Student values(\u0026#39;01\u0026#39; , \u0026#39;赵雷\u0026#39; , \u0026#39;1990-01-01\u0026#39; , \u0026#39;男\u0026#39;); insert into Student values(\u0026#39;02\u0026#39; , \u0026#39;钱电\u0026#39; , \u0026#39;1990-12-21\u0026#39; , \u0026#39;男\u0026#39;); insert into Student values(\u0026#39;03\u0026#39; , \u0026#39;孙风\u0026#39; , \u0026#39;1990-05-20\u0026#39; , \u0026#39;男\u0026#39;); insert into Student values(\u0026#39;04\u0026#39; , \u0026#39;李云\u0026#39; , \u0026#39;1990-08-06\u0026#39; , \u0026#39;男\u0026#39;); insert into Student values(\u0026#39;05\u0026#39; , \u0026#39;周梅\u0026#39; , \u0026#39;1991-12-01\u0026#39; , \u0026#39;女\u0026#39;); insert into Student values(\u0026#39;06\u0026#39; , \u0026#39;吴兰\u0026#39; , \u0026#39;1992-03-01\u0026#39; , \u0026#39;女\u0026#39;); insert into Student values(\u0026#39;07\u0026#39; , \u0026#39;郑竹\u0026#39; , \u0026#39;1989-07-01\u0026#39; , \u0026#39;女\u0026#39;); insert into Student values(\u0026#39;08\u0026#39; , \u0026#39;王菊\u0026#39; , \u0026#39;1990-01-20\u0026#39; , \u0026#39;女\u0026#39;); create table Course(CID varchar(10),Cname nvarchar(10),TID varchar(10)); insert into Course values(\u0026#39;01\u0026#39; , \u0026#39;语文\u0026#39; , \u0026#39;02\u0026#39;); insert into Course values(\u0026#39;02\u0026#39; , \u0026#39;数学\u0026#39; , \u0026#39;01\u0026#39;); insert into Course values(\u0026#39;03\u0026#39; , \u0026#39;英语\u0026#39; , \u0026#39;03\u0026#39;); create table Teacher(TID varchar(10),Tname nvarchar(10)); insert into Teacher values(\u0026#39;01\u0026#39; , \u0026#39;张三\u0026#39;); insert into Teacher values(\u0026#39;02\u0026#39; , \u0026#39;李四\u0026#39;); insert into Teacher values(\u0026#39;03\u0026#39; , \u0026#39;王五\u0026#39;); create table SC(SID varchar(10),CID varchar(10),score decimal(18,1)); insert into SC values(\u0026#39;01\u0026#39; , \u0026#39;01\u0026#39; , 80); insert into SC values(\u0026#39;01\u0026#39; , \u0026#39;02\u0026#39; , 90); insert into SC values(\u0026#39;01\u0026#39; , \u0026#39;03\u0026#39; , 99); insert into SC values(\u0026#39;02\u0026#39; , \u0026#39;01\u0026#39; , 70); insert into SC values(\u0026#39;02\u0026#39; , \u0026#39;02\u0026#39; , 60); insert into SC values(\u0026#39;02\u0026#39; , \u0026#39;03\u0026#39; , 80); insert into SC values(\u0026#39;03\u0026#39; , \u0026#39;01\u0026#39; , 80); insert into SC values(\u0026#39;03\u0026#39; , \u0026#39;02\u0026#39; , 80); insert into SC values(\u0026#39;03\u0026#39; , \u0026#39;03\u0026#39; , 80); insert into SC values(\u0026#39;04\u0026#39; , \u0026#39;01\u0026#39; , 50); insert into SC values(\u0026#39;04\u0026#39; , \u0026#39;02\u0026#39; , 30); insert into SC values(\u0026#39;04\u0026#39; , \u0026#39;03\u0026#39; , 20); insert into SC values(\u0026#39;05\u0026#39; , \u0026#39;01\u0026#39; , 76); insert into SC values(\u0026#39;05\u0026#39; , \u0026#39;02\u0026#39; , 87); insert into SC values(\u0026#39;06\u0026#39; , \u0026#39;01\u0026#39; , 31); insert into SC values(\u0026#39;06\u0026#39; , \u0026#39;03\u0026#39; , 34); insert into SC values(\u0026#39;07\u0026#39; , \u0026#39;02\u0026#39; , 89); insert into SC values(\u0026#39;07\u0026#39; , \u0026#39;03\u0026#39; , 98); 题目  查询\u0026quot;01\u0026quot;课程比\u0026quot;02\u0026quot;课程成绩高的学生的信息及课程分数   查询同时存在\u0026quot;01\u0026quot;课程和\u0026quot;02\u0026quot;课程的情况 结果:  +------+-------+---------------------+------+------------+------------+ | SID | Sname | Sage | Ssex | 01课程分数 | 02课程分数 | +------+-------+---------------------+------+------------+------------+ | 02 | 钱电 | 1990-12-21 00:00:00 | 男 | 70.","keywords":["SQL"],"articleBody":" 闲着没事情做几道SQL题。 Orcal SQL: 在线SQL测试\nMySQL指定进入某个端口命令\nmysql -uroot -p -P 3307 问题描述 1.学生表 Student(SID,Sname,Sage,Ssex) –SID 学生编号,Sname 学生姓名,Sage 出生年月,Ssex 学生性别. 2.课程表 Course(CID,Cname,TID) –CID –课程编号,Cname 课程名称,TID 教师编号. 3.教师表 Teacher(TID,Tname) –TID 教师编号,Tname 教师姓名. 4.成绩表 SC(SID,CID,score) –SID 学生编号,CID 课程编号,score 分数. 建表语句:\ncreate table Student(SID varchar(10),Sname nvarchar(10),Sage datetime,Ssex nvarchar(10)); insert into Student values('01' , '赵雷' , '1990-01-01' , '男'); insert into Student values('02' , '钱电' , '1990-12-21' , '男'); insert into Student values('03' , '孙风' , '1990-05-20' , '男'); insert into Student values('04' , '李云' , '1990-08-06' , '男'); insert into Student values('05' , '周梅' , '1991-12-01' , '女'); insert into Student values('06' , '吴兰' , '1992-03-01' , '女'); insert into Student values('07' , '郑竹' , '1989-07-01' , '女'); insert into Student values('08' , '王菊' , '1990-01-20' , '女'); create table Course(CID varchar(10),Cname nvarchar(10),TID varchar(10)); insert into Course values('01' , '语文' , '02'); insert into Course values('02' , '数学' , '01'); insert into Course values('03' , '英语' , '03'); create table Teacher(TID varchar(10),Tname nvarchar(10)); insert into Teacher values('01' , '张三'); insert into Teacher values('02' , '李四'); insert into Teacher values('03' , '王五'); create table SC(SID varchar(10),CID varchar(10),score decimal(18,1)); insert into SC values('01' , '01' , 80); insert into SC values('01' , '02' , 90); insert into SC values('01' , '03' , 99); insert into SC values('02' , '01' , 70); insert into SC values('02' , '02' , 60); insert into SC values('02' , '03' , 80); insert into SC values('03' , '01' , 80); insert into SC values('03' , '02' , 80); insert into SC values('03' , '03' , 80); insert into SC values('04' , '01' , 50); insert into SC values('04' , '02' , 30); insert into SC values('04' , '03' , 20); insert into SC values('05' , '01' , 76); insert into SC values('05' , '02' , 87); insert into SC values('06' , '01' , 31); insert into SC values('06' , '03' , 34); insert into SC values('07' , '02' , 89); insert into SC values('07' , '03' , 98); 题目  查询\"01\"课程比\"02\"课程成绩高的学生的信息及课程分数   查询同时存在\"01\"课程和\"02\"课程的情况 结果:  +------+-------+---------------------+------+------------+------------+ | SID | Sname | Sage | Ssex | 01课程分数 | 02课程分数 | +------+-------+---------------------+------+------------+------------+ | 02 | 钱电 | 1990-12-21 00:00:00 | 男 | 70.0 | 60.0 | | 04 | 李云 | 1990-08-06 00:00:00 | 男 | 50.0 | 30.0 | +------+-------+---------------------+------+------------+------------+ 2 rows in set (0.00 sec) select a.* , b.score 01课程分数, c.score 02课程分数 from Student a, SC b, SC c where a.SID=b.SID and a.SID=c.SID and b.CID=\"01\" and c.CID=\"02\" and b.scorec.score;  查询同时存在\"01\"课程和\"02\"课程的情况和存在\"01\"课程但可能不存在\"02\"课程的情况(不存在时显示为null)(以下存在相同内容时不再解释). 结果:  +------+-------+---------------------+------+------------+------------+ | SID | Sname | Sage | Ssex | 01课程分数 | 02课程分数 | +------+-------+---------------------+------+------------+------------+ | 01 | 赵雷 | 1990-01-01 00:00:00 | 男 | 80.0 | 90.0 | | 02 | 钱电 | 1990-12-21 00:00:00 | 男 | 70.0 | 60.0 | | 03 | 孙风 | 1990-05-20 00:00:00 | 男 | 80.0 | 80.0 | | 04 | 李云 | 1990-08-06 00:00:00 | 男 | 50.0 | 30.0 | | 05 | 周梅 | 1991-12-01 00:00:00 | 女 | 76.0 | 87.0 | | 06 | 吴兰 | 1992-03-01 00:00:00 | 女 | 31.0 | NULL | +------+-------+---------------------+------+------------+------------+ 6 rows in set (0.00 sec) select a.*,b.score 01课程分数,c.score 02课程分数 from Student a left join SC b on b.SID=a.SID and b.CID='01' left join SC c on c.SID=a.SID and c.CID='02' where b.scoreisnull(c.score); 查询平均成绩大于等于60分的同学的学生编号和学生姓名和平均成绩. CAST()函数:CAST('12.5' AS decimal(9,2)) 如果通过CAST()函数将这个值转换为decimal表示精度与小数位数分别为9与2. 结果:  +------+-------+-----------+ | SID | Sname | avg_socre | +------+-------+-----------+ | 01 | 赵雷 | 89.67 | | 02 | 钱电 | 70.00 | | 03 | 孙风 | 80.00 | | 05 | 周梅 | 81.50 | | 07 | 郑竹 | 93.50 | +------+-------+-----------+ 5 rows in set (0.00 sec) select a.SID,a.Sname,cast(avg(b.score) as decimal(10,2))avg_socre from Student a, SC b where a.SID=b.SID group by a.SID,a.Sname having cast(avg(b.score) as decimal(10,2))=60 order by a.SID; 查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩.   查询所有有成绩的SQL. 结果:  +------+-------+----------+--------+ | SID | Sname | 选课总数 | 总成绩 | +------+-------+----------+--------+ | 01 | 赵雷 | 3 | 269.0 | | 02 | 钱电 | 3 | 210.0 | | 03 | 孙风 | 3 | 240.0 | | 04 | 李云 | 3 | 100.0 | | 05 | 周梅 | 2 | 163.0 | | 06 | 吴兰 | 2 | 65.0 | | 07 | 郑竹 | 2 | 187.0 | +------+-------+----------+--------+ 7 rows in set (0.00 sec) select a.SID,a.Sname,count(b.CID) 选课总数,sum(b.score) 总成绩 from Student a, SC b where a.SID=b.SID group by a.SID, a.Sname order by a.SID  查询所有(包括有成绩和无成绩)的SQL. 结果:  +------+-------+--------------+------------+ | SID | Sname | count(b.CID) | sum(score) | +------+-------+--------------+------------+ | 01 | 赵雷 | 3 | 269.0 | | 02 | 钱电 | 3 | 210.0 | | 03 | 孙风 | 3 | 240.0 | | 04 | 李云 | 3 | 100.0 | | 05 | 周梅 | 2 | 163.0 | | 06 | 吴兰 | 2 | 65.0 | | 07 | 郑竹 | 2 | 187.0 | | 08 | 王菊 | 0 | NULL | +------+-------+--------------+------------+ 8 rows in set (0.00 sec) select a.SID,a.Sname,count(b.CID),sum(score) from Student a left join SC b on a.SID=b.SID group by a.SID, a.Sname order by a.SID; 查询\"李\"姓老师的数量. 结果:  +----------+ | 教师数量 | +----------+ | 1 | +----------+ 1 row in set (0.00 sec) -- 1 select count(Tname)教师数量 from Teacher where Tname like '李%'; -- 2 select count(Tname)教师数量 from Teacher where left(Tname, 1)='李'; 查询学过\"张三\"老师授课的同学的信息. 结果:  +------+-------+---------------------+------+ | SID | Sname | Sage | Ssex | +------+-------+---------------------+------+ | 01 | 赵雷 | 1990-01-01 00:00:00 | 男 | | 02 | 钱电 | 1990-12-21 00:00:00 | 男 | | 03 | 孙风 | 1990-05-20 00:00:00 | 男 | | 04 | 李云 | 1990-08-06 00:00:00 | 男 | | 05 | 周梅 | 1991-12-01 00:00:00 | 女 | | 07 | 郑竹 | 1989-07-01 00:00:00 | 女 | +------+-------+---------------------+------+ 6 rows in set (0.00 sec) select Student.* from Student,SC,Course,Teacher where Student.SID=SC.SID and SC.CID=Course.CID and Course.TID=Teacher.TID and Teacher.Tname=\"张三\" order by Student.SID; 查询没学过\"张三\"老师授课的同学的信息 结果:  +------+-------+---------------------+------+ | SID | Sname | Sage | Ssex | +------+-------+---------------------+------+ | 06 | 吴兰 | 1992-03-01 00:00:00 | 女 | | 08 | 王菊 | 1990-01-20 00:00:00 | 女 | +------+-------+---------------------+------+ 2 rows in set (0.00 sec) select s.* from Student s where SID not in ( select SC.SID from SC,Course,Teacher where SC.CID=Course.CID and Course.TID=Teacher.TID and Teacher.Tname=\"张三\" ) order by s.SID; 查询学过编号为\"01\"并且也学过编号为\"02\"的课程的同学的信息. 结果:  +------+-------+---------------------+------+ | SID | Sname | Sage | Ssex | +------+-------+---------------------+------+ | 01 | 赵雷 | 1990-01-01 00:00:00 | 男 | | 02 | 钱电 | 1990-12-21 00:00:00 | 男 | | 03 | 孙风 | 1990-05-20 00:00:00 | 男 | | 04 | 李云 | 1990-08-06 00:00:00 | 男 | | 05 | 周梅 | 1991-12-01 00:00:00 | 女 | +------+-------+---------------------+------+ 5 rows in set (0.00 sec) -- 1 select Student.* from Student,SC where Student.SID=SC.SID and SC.CID='01' and exists ( select * from SC sc_2 where sc_2.CID='02' and sc_2.SID=SC.SID ) order by Student.SID; -- 2 select s.* from Student s where s.SID in ( select SID from ( select SID from SC where SC.CID='01' union all select SID from SC where SC.CID='02' ) t group by SID having count(1) = 2 ) order by s.SID; 查询没有学全所有课程的同学的信息. 结果:  +------+-------+---------------------+------+ | SID | Sname | Sage | Ssex | +------+-------+---------------------+------+ | 05 | 周梅 | 1991-12-01 00:00:00 | 女 | | 06 | 吴兰 | 1992-03-01 00:00:00 | 女 | | 07 | 郑竹 | 1989-07-01 00:00:00 | 女 | +------+-------+---------------------+------+ 3 rows in set (0.01 sec) -- 1 select Student.* from Student,SC where Student.SID=SC.SID group by Student.SID,Student.Sname,Student.Sage,Student.Ssex having count(CID)  (select count(CID) from Course); -- 2 select Student.* from Student left join SC on Student.SID=SC.SID group by Student.SID,Student.Sname,Student.Sage,Student.Ssex having count(CID)(select count(CID) from Course); select * from Student left join SC on Student.SID=SC.SID left join Course on SC.CID=Course.CID order by Student.SID; 查询至少有一门课与学号为\"01\"的同学所学相同的同学的信息. 结果:  +------+-------+---------------------+------+ | SID | Sname | Sage | Ssex | +------+-------+---------------------+------+ | 02 | 钱电 | 1990-12-21 00:00:00 | 男 | | 03 | 孙风 | 1990-05-20 00:00:00 | 男 | | 04 | 李云 | 1990-08-06 00:00:00 | 男 | | 05 | 周梅 | 1991-12-01 00:00:00 | 女 | | 06 | 吴兰 | 1992-03-01 00:00:00 | 女 | | 07 | 郑竹 | 1989-07-01 00:00:00 | 女 | +------+-------+---------------------+------+ 6 rows in set (0.00 sec) select distinct Student.* from Student, SC where Student.SID=SC.SID and SC.CID in ( select CID from SC where SC.SID='01' ) and Student.SID!='01'; 查询没学过\"张三\"老师讲授的任一门课程的学生姓名. 结果:  +------+-------+ | SID | Sname | +------+-------+ | 06 | 吴兰 | | 08 | 王菊 | +------+-------+ 2 rows in set (0.00 sec) select Student.SID,Student.Sname from Student where Student.SID not in ( select distinct SC.SID from SC,Course,Teacher where SC.CID=Course.CID and Course.TID=Teacher.TID and Teacher.Tname=\"张三\" ) order by Student.SID; 查询和\"01\"号的同学学习的课程完全相同的其他同学的信息. 结果:  +------+-------+---------------------+------+ | SID | Sname | Sage | Ssex | +------+-------+---------------------+------+ | 02 | 钱电 | 1990-12-21 00:00:00 | 男 | | 03 | 孙风 | 1990-05-20 00:00:00 | 男 | | 04 | 李云 | 1990-08-06 00:00:00 | 男 | +------+-------+---------------------+------+ 3 rows in set (0.00 sec) -- 这个只是按数量算... select Student.* from Student where SID in ( select distinct SC.SID from SC where SID!='01' and SC.CID in ( select distinct CID from SC where SID='01' ) group by SC.SID having count(1)=(select count(1) from SC where SID='01') ); 查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩. 结果:  +------+-------+-----------+ | SID | Sname | avg_score | +------+-------+-----------+ | 04 | 李云 | 33.33 | | 06 | 吴兰 | 32.50 | +------+-------+-----------+ 2 rows in set (0.00 sec) -- group by(分组)having(条件) 用法. -- select Ssex from Student group by Ssex having Ssex!='男'; select SID from SC where score  60 group by SID having count(1) = 2 select Student.SID, Student.Sname, cast(avg(score) as decimal(10, 2)) avg_score from Student, SC where Student.SID=SC.SID and Student.SID in ( select SID from SC where score60 group by SID having count(1)=2 ) group by Student.SID,Student.Sname; 检索\"01\"课程分数小于60，按分数降序排列的学生信息. 结果:  +------+-------+---------------------+------+-------+------+ | SID | Sname | Sage | Ssex | score | CID | +------+-------+---------------------+------+-------+------+ | 04 | 李云 | 1990-08-06 00:00:00 | 男 | 50.0 | 01 | | 06 | 吴兰 | 1992-03-01 00:00:00 | 女 | 34.0 | 03 | | 06 | 吴兰 | 1992-03-01 00:00:00 | 女 | 31.0 | 01 | | 04 | 李云 | 1990-08-06 00:00:00 | 男 | 30.0 | 02 | | 04 | 李云 | 1990-08-06 00:00:00 | 男 | 20.0 | 03 | +------+-------+---------------------+------+-------+------+ 5 rows in set (0.00 sec) select distinct Student.*,SC.score,Course.CID from Student,SC,Course where Student.SID=SC.SID and SC.CID=Course.CID and Student.SID in ( select SID from SC,Course where SC.CID=Course.CID and SC.score60 and Course.CID='01' ) order by SC.score desc; 按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩. 结果:  +------+------+------+------+------+--------+ | 学号 | 姓名 | 语文 | 数学 | 英语 | 平均分 | +------+------+------+------+------+--------+ | 07 | 郑竹 | NULL | 89.0 | 98.0 | 93.50 | | 01 | 赵雷 | 80.0 | 90.0 | 99.0 | 89.67 | | 05 | 周梅 | 76.0 | 87.0 | NULL | 81.50 | | 03 | 孙风 | 80.0 | 80.0 | 80.0 | 80.00 | | 02 | 钱电 | 70.0 | 60.0 | 80.0 | 70.00 | | 04 | 李云 | 50.0 | 30.0 | 20.0 | 33.33 | | 06 | 吴兰 | 31.0 | NULL | 34.0 | 32.50 | | 08 | 王菊 | NULL | NULL | NULL | NULL | +------+------+------+------+------+--------+ 8 rows in set (0.00 sec) -- 列转行 select a.SID 学号,a.Sname 姓名, max(case c.Cname when '语文' then b.score else null end) 语文, max(case c.Cname when '数学' then b.score else null end) 数学, max(case c.Cname when '英语' then b.score else null end) 英语, cast(avg(b.score) as decimal(18, 2)) 平均分 from student a left join SC b on a.SID=b.SID left join Course c on b.CID=c.CID group by a.SID, a.Sname order by 平均分 desc; 查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率 –及格为=60，中等为：70-80，优良为：80-90，优秀为：=90. 结果:  +----------+----------+--------+--------+--------+--------+--------+--------+--------+ | 课程编号 | 课程名称 | 最高分 | 最低分 | 平均分 | 及格率 | 中等率 | 优良率 | 优秀率 | +----------+----------+--------+--------+--------+--------+--------+--------+--------+ | 01 | 语文 | 80.0 | 31.0 | 64.50 | 66.67 | 33.33 | 33.33 | 0.00 | | 02 | 数学 | 90.0 | 30.0 | 72.67 | 83.33 | 0.00 | 50.00 | 16.67 | | 03 | 英语 | 99.0 | 20.0 | 68.50 | 66.67 | 0.00 | 33.33 | 33.33 | +----------+----------+--------+--------+--------+--------+--------+--------+--------+ 3 rows in set (0.07 sec) -- 1 select m.CID 课程编号,m.Cname 课程名称,max(n.score) 最高分,min(n.score) 最低分, cast(avg(n.score) as decimal(18,2)) 平均分, cast((select count(1) from sc where CID=m.CID and score=60)*100.0/(select count(1) from sc where CID=m.CID) as decimal(18, 2)) 及格率, cast((select count(1) from sc where CID = m.CID and score = 70 and score  80 )*100.0 / (select count(1) from sc where CID = m.CID) as decimal(18,2)) 中等率 , cast((select count(1) from sc where CID = m.CID and score = 80 and score  90 )*100.0 / (select count(1) from sc where CID = m.CID) as decimal(18,2)) 优良率 , cast((select count(1) from sc where CID = m.CID and score = 90)*100.0 / (select count(1) from sc where CID = m.CID) as decimal(18,2)) 优秀率 from course m,sc n where m.CID=n.CID group by m.CID,m.Cname order by m.CID; -- 2 select m.CID 课程编号 , m.Cname 课程名称 , (select max(score) from SC where CID = m.CID) 最高分 , (select min(score) from SC where CID = m.CID) 最低分 , (select cast(avg(score) as decimal(18,2)) from SC where CID = m.CID) 平均分 , cast((select count(1) from SC where CID = m.CID and score = 60)*100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 及格率, cast((select count(1) from SC where CID = m.CID and score = 70 and score  80 )*100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 中等率 , cast((select count(1) from SC where CID = m.CID and score = 80 and score  90 )*100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 优良率 , cast((select count(1) from SC where CID = m.CID and score = 90)*100.0 / (select count(1) from SC where CID = m.CID) as decimal(18,2)) 优秀率 from Course m order by m.CID;  我实在是太难了………… 16. 按各科成绩进行排序，并显示排名.\n Score重复时保留名次空缺. 结果:  --- emmm  Score重复时合并名次(DENSE_RANK完成). 结果:  查询学生的总成绩并进行排名.   查询学生的总成绩. 结果:   查询学生的总成绩并进行排名，sql 2000用子查询完成，分总分重复时保留名次空缺和不保留名次空缺两种。 结果:   查询学生的总成绩并进行排名，sql 2005用rank,DENSE_RANK完成，分总分重复时保留名次空缺和不保留名次空缺两种。 结果:  未完待续~\n","wordCount":"2299","inLanguage":"en","datePublished":"2019-10-15T23:15:47Z","dateModified":"2019-10-15T23:15:47Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://razielez.github.io/posts/%E5%87%A0%E9%81%93sql%E7%BB%83%E4%B9%A0%E9%A2%98/"},"publisher":{"@type":"Organization","name":"Razielez's Blog","logo":{"@type":"ImageObject","url":"https://razielez.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://razielez.github.io accesskey=h title="Razielez's Blog (Alt + H)">Razielez's Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://razielez.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://razielez.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://razielez.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://razielez.github.io/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://razielez.github.io>Home</a>&nbsp;»&nbsp;<a href=https://razielez.github.io/posts/>Posts</a></div><h1 class=post-title>SQL练习题</h1><div class=post-meta>2019-10-15&nbsp;·&nbsp;11 min</div></header><div class=post-content><hr><p>闲着没事情做几道SQL题。
Orcal SQL: <a href=https://livesql.oracle.com>在线SQL测试</a></p><p>MySQL指定进入某个端口命令</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>mysql -uroot -p -P <span style=color:#ae81ff>3307</span>
</code></pre></div><h2 id=问题描述>问题描述<a hidden class=anchor aria-hidden=true href=#问题描述>#</a></h2><p>1.学生表
Student(SID,Sname,Sage,Ssex) &ndash;SID 学生编号,Sname 学生姓名,Sage 出生年月,Ssex 学生性别.
2.课程表
Course(CID,Cname,TID) &ndash;CID &ndash;课程编号,Cname 课程名称,TID 教师编号.
3.教师表
Teacher(TID,Tname) &ndash;TID 教师编号,Tname 教师姓名.
4.成绩表
SC(SID,CID,score) &ndash;SID 学生编号,CID 课程编号,score 分数.
建表语句:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> Student(SID varchar(<span style=color:#ae81ff>10</span>),Sname nvarchar(<span style=color:#ae81ff>10</span>),Sage datetime,Ssex nvarchar(<span style=color:#ae81ff>10</span>));
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Student <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#e6db74>&#39;赵雷&#39;</span> , <span style=color:#e6db74>&#39;1990-01-01&#39;</span> , <span style=color:#e6db74>&#39;男&#39;</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Student <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#e6db74>&#39;钱电&#39;</span> , <span style=color:#e6db74>&#39;1990-12-21&#39;</span> , <span style=color:#e6db74>&#39;男&#39;</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Student <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#e6db74>&#39;孙风&#39;</span> , <span style=color:#e6db74>&#39;1990-05-20&#39;</span> , <span style=color:#e6db74>&#39;男&#39;</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Student <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;04&#39;</span> , <span style=color:#e6db74>&#39;李云&#39;</span> , <span style=color:#e6db74>&#39;1990-08-06&#39;</span> , <span style=color:#e6db74>&#39;男&#39;</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Student <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;05&#39;</span> , <span style=color:#e6db74>&#39;周梅&#39;</span> , <span style=color:#e6db74>&#39;1991-12-01&#39;</span> , <span style=color:#e6db74>&#39;女&#39;</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Student <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;06&#39;</span> , <span style=color:#e6db74>&#39;吴兰&#39;</span> , <span style=color:#e6db74>&#39;1992-03-01&#39;</span> , <span style=color:#e6db74>&#39;女&#39;</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Student <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;07&#39;</span> , <span style=color:#e6db74>&#39;郑竹&#39;</span> , <span style=color:#e6db74>&#39;1989-07-01&#39;</span> , <span style=color:#e6db74>&#39;女&#39;</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Student <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;08&#39;</span> , <span style=color:#e6db74>&#39;王菊&#39;</span> , <span style=color:#e6db74>&#39;1990-01-20&#39;</span> , <span style=color:#e6db74>&#39;女&#39;</span>);
<span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> Course(CID varchar(<span style=color:#ae81ff>10</span>),Cname nvarchar(<span style=color:#ae81ff>10</span>),TID varchar(<span style=color:#ae81ff>10</span>));
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Course <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#e6db74>&#39;语文&#39;</span> , <span style=color:#e6db74>&#39;02&#39;</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Course <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#e6db74>&#39;数学&#39;</span> , <span style=color:#e6db74>&#39;01&#39;</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Course <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#e6db74>&#39;英语&#39;</span> , <span style=color:#e6db74>&#39;03&#39;</span>);
<span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> Teacher(TID varchar(<span style=color:#ae81ff>10</span>),Tname nvarchar(<span style=color:#ae81ff>10</span>));
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Teacher <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#e6db74>&#39;张三&#39;</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Teacher <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#e6db74>&#39;李四&#39;</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> Teacher <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#e6db74>&#39;王五&#39;</span>);
<span style=color:#66d9ef>create</span> <span style=color:#66d9ef>table</span> SC(SID varchar(<span style=color:#ae81ff>10</span>),CID varchar(<span style=color:#ae81ff>10</span>),score decimal(<span style=color:#ae81ff>18</span>,<span style=color:#ae81ff>1</span>));
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#ae81ff>80</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#ae81ff>90</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#ae81ff>99</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#ae81ff>70</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#ae81ff>60</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#ae81ff>80</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#ae81ff>80</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#ae81ff>80</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#ae81ff>80</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;04&#39;</span> , <span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#ae81ff>50</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;04&#39;</span> , <span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#ae81ff>30</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;04&#39;</span> , <span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#ae81ff>20</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;05&#39;</span> , <span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#ae81ff>76</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;05&#39;</span> , <span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#ae81ff>87</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;06&#39;</span> , <span style=color:#e6db74>&#39;01&#39;</span> , <span style=color:#ae81ff>31</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;06&#39;</span> , <span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#ae81ff>34</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;07&#39;</span> , <span style=color:#e6db74>&#39;02&#39;</span> , <span style=color:#ae81ff>89</span>);
<span style=color:#66d9ef>insert</span> <span style=color:#66d9ef>into</span> SC <span style=color:#66d9ef>values</span>(<span style=color:#e6db74>&#39;07&#39;</span> , <span style=color:#e6db74>&#39;03&#39;</span> , <span style=color:#ae81ff>98</span>);
</code></pre></div><h2 id=题目>题目<a hidden class=anchor aria-hidden=true href=#题目>#</a></h2><ol><li>查询"01"课程比"02"课程成绩高的学生的信息及课程分数</li></ol><ul><li>查询同时存在"01"课程和"02"课程的情况
结果:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+---------------------+------+------------+------------+
| SID  | Sname | Sage                | Ssex | 01课程分数 | 02课程分数 |
+------+-------+---------------------+------+------------+------------+
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   |       70.0 |       60.0 |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   |       50.0 |       30.0 |
+------+-------+---------------------+------+------------+------------+
2 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> a.<span style=color:#f92672>*</span> , b.score <span style=color:#ae81ff>01</span><span style=color:#960050;background-color:#1e0010>课程分数</span>, <span style=color:#66d9ef>c</span>.score <span style=color:#ae81ff>02</span><span style=color:#960050;background-color:#1e0010>课程分数</span> <span style=color:#66d9ef>from</span> Student a, SC b, SC <span style=color:#66d9ef>c</span>
<span style=color:#66d9ef>where</span> a.SID<span style=color:#f92672>=</span>b.SID <span style=color:#66d9ef>and</span> a.SID<span style=color:#f92672>=</span><span style=color:#66d9ef>c</span>.SID <span style=color:#66d9ef>and</span> b.CID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;01&#34;</span> <span style=color:#66d9ef>and</span> <span style=color:#66d9ef>c</span>.CID<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;02&#34;</span> <span style=color:#66d9ef>and</span> b.score<span style=color:#f92672>&gt;</span><span style=color:#66d9ef>c</span>.score;
</code></pre></div><ul><li>查询同时存在"01"课程和"02"课程的情况和存在"01"课程但可能不存在"02"课程的情况(不存在时显示为null)(以下存在相同内容时不再解释).
结果:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+---------------------+------+------------+------------+
| SID  | Sname | Sage                | Ssex | 01课程分数 | 02课程分数 |
+------+-------+---------------------+------+------------+------------+
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   |       80.0 |       90.0 |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   |       70.0 |       60.0 |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   |       80.0 |       80.0 |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   |       50.0 |       30.0 |
| 05   | 周梅  | 1991-12-01 00:00:00 | 女   |       76.0 |       87.0 |
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   |       31.0 |       NULL |
+------+-------+---------------------+------+------------+------------+
6 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> a.<span style=color:#f92672>*</span>,b.score <span style=color:#ae81ff>01</span><span style=color:#960050;background-color:#1e0010>课程分数</span>,<span style=color:#66d9ef>c</span>.score <span style=color:#ae81ff>02</span><span style=color:#960050;background-color:#1e0010>课程分数</span> <span style=color:#66d9ef>from</span> Student a
<span style=color:#66d9ef>left</span> <span style=color:#66d9ef>join</span> SC b <span style=color:#66d9ef>on</span> b.SID<span style=color:#f92672>=</span>a.SID <span style=color:#66d9ef>and</span> b.CID<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;01&#39;</span>
<span style=color:#66d9ef>left</span> <span style=color:#66d9ef>join</span> SC <span style=color:#66d9ef>c</span> <span style=color:#66d9ef>on</span> <span style=color:#66d9ef>c</span>.SID<span style=color:#f92672>=</span>a.SID <span style=color:#66d9ef>and</span> <span style=color:#66d9ef>c</span>.CID<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;02&#39;</span>
<span style=color:#66d9ef>where</span> b.score<span style=color:#f92672>&gt;</span><span style=color:#66d9ef>isnull</span>(<span style=color:#66d9ef>c</span>.score);
</code></pre></div><ol start=2><li>查询平均成绩大于等于60分的同学的学生编号和学生姓名和平均成绩.
<code>CAST()</code>函数:<code>CAST('12.5' AS decimal(9,2))</code>
如果通过<code>CAST()</code>函数将这个值转换为<code>decimal</code>表示精度与小数位数分别为9与2.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+-----------+
| SID  | Sname | avg_socre |
+------+-------+-----------+
| 01   | 赵雷  |     89.67 |
| 02   | 钱电  |     70.00 |
| 03   | 孙风  |     80.00 |
| 05   | 周梅  |     81.50 |
| 07   | 郑竹  |     93.50 |
+------+-------+-----------+
5 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> a.SID,a.Sname,<span style=color:#66d9ef>cast</span>(<span style=color:#66d9ef>avg</span>(b.score) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>2</span>))avg_socre
<span style=color:#66d9ef>from</span> Student a, SC b
<span style=color:#66d9ef>where</span> a.SID<span style=color:#f92672>=</span>b.SID
<span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> a.SID,a.Sname
<span style=color:#66d9ef>having</span> <span style=color:#66d9ef>cast</span>(<span style=color:#66d9ef>avg</span>(b.score) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>2</span>))<span style=color:#f92672>&gt;=</span><span style=color:#ae81ff>60</span>
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> a.SID;
</code></pre></div><ol start=3><li>查询所有同学的学生编号、学生姓名、选课总数、所有课程的总成绩.</li></ol><ul><li>查询所有有成绩的SQL.
结果:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+----------+--------+
| SID  | Sname | 选课总数 | 总成绩 |
+------+-------+----------+--------+
| 01   | 赵雷  |        3 |  269.0 |
| 02   | 钱电  |        3 |  210.0 |
| 03   | 孙风  |        3 |  240.0 |
| 04   | 李云  |        3 |  100.0 |
| 05   | 周梅  |        2 |  163.0 |
| 06   | 吴兰  |        2 |   65.0 |
| 07   | 郑竹  |        2 |  187.0 |
+------+-------+----------+--------+
7 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> a.SID,a.Sname,<span style=color:#66d9ef>count</span>(b.CID) <span style=color:#960050;background-color:#1e0010>选课总数</span>,<span style=color:#66d9ef>sum</span>(b.score) <span style=color:#960050;background-color:#1e0010>总成绩</span>
<span style=color:#66d9ef>from</span> Student a, SC b
<span style=color:#66d9ef>where</span> a.SID<span style=color:#f92672>=</span>b.SID
<span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> a.SID, a.Sname
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> a.SID
</code></pre></div><ul><li>查询所有(包括有成绩和无成绩)的SQL.
结果:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+--------------+------------+
| SID  | Sname | count(b.CID) | sum(score) |
+------+-------+--------------+------------+
| 01   | 赵雷  |            3 |      269.0 |
| 02   | 钱电  |            3 |      210.0 |
| 03   | 孙风  |            3 |      240.0 |
| 04   | 李云  |            3 |      100.0 |
| 05   | 周梅  |            2 |      163.0 |
| 06   | 吴兰  |            2 |       65.0 |
| 07   | 郑竹  |            2 |      187.0 |
| 08   | 王菊  |            0 |       NULL |
+------+-------+--------------+------------+
8 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> a.SID,a.Sname,<span style=color:#66d9ef>count</span>(b.CID),<span style=color:#66d9ef>sum</span>(score)
<span style=color:#66d9ef>from</span> Student a
<span style=color:#66d9ef>left</span> <span style=color:#66d9ef>join</span> SC b
<span style=color:#66d9ef>on</span> a.SID<span style=color:#f92672>=</span>b.SID
<span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> a.SID, a.Sname
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> a.SID;
</code></pre></div><ol start=4><li>查询"李"姓老师的数量.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+----------+
| 教师数量 |
+----------+
|        1 |
+----------+
1 row in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- 1
</span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(Tname)<span style=color:#960050;background-color:#1e0010>教师数量</span> <span style=color:#66d9ef>from</span> Teacher <span style=color:#66d9ef>where</span> Tname <span style=color:#66d9ef>like</span> <span style=color:#e6db74>&#39;李%&#39;</span>; 
<span style=color:#75715e>-- 2
</span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(Tname)<span style=color:#960050;background-color:#1e0010>教师数量</span> <span style=color:#66d9ef>from</span> Teacher <span style=color:#66d9ef>where</span> <span style=color:#66d9ef>left</span>(Tname, <span style=color:#ae81ff>1</span>)<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;李&#39;</span>;
</code></pre></div><ol start=5><li>查询学过"张三"老师授课的同学的信息.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+---------------------+------+
| SID  | Sname | Sage                | Ssex |
+------+-------+---------------------+------+
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   |
| 05   | 周梅  | 1991-12-01 00:00:00 | 女   |
| 07   | 郑竹  | 1989-07-01 00:00:00 | 女   |
+------+-------+---------------------+------+
6 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> Student.<span style=color:#f92672>*</span> 
<span style=color:#66d9ef>from</span> Student,SC,Course,Teacher
<span style=color:#66d9ef>where</span> Student.SID<span style=color:#f92672>=</span>SC.SID <span style=color:#66d9ef>and</span> SC.CID<span style=color:#f92672>=</span>Course.CID <span style=color:#66d9ef>and</span> Course.TID<span style=color:#f92672>=</span>Teacher.TID 
<span style=color:#66d9ef>and</span> Teacher.Tname<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;张三&#34;</span>
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> Student.SID;
</code></pre></div><ol start=6><li>查询没学过"张三"老师授课的同学的信息
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+---------------------+------+
| SID  | Sname | Sage                | Ssex |
+------+-------+---------------------+------+
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   |
| 08   | 王菊  | 1990-01-20 00:00:00 | 女   |
+------+-------+---------------------+------+
2 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> s.<span style=color:#f92672>*</span>
<span style=color:#66d9ef>from</span> Student s
<span style=color:#66d9ef>where</span> SID <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>in</span>
(
<span style=color:#66d9ef>select</span> SC.SID
<span style=color:#66d9ef>from</span> SC,Course,Teacher
<span style=color:#66d9ef>where</span> SC.CID<span style=color:#f92672>=</span>Course.CID <span style=color:#66d9ef>and</span> Course.TID<span style=color:#f92672>=</span>Teacher.TID 
<span style=color:#66d9ef>and</span> Teacher.Tname<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;张三&#34;</span>
)
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> s.SID;
</code></pre></div><ol start=7><li>查询学过编号为"01"并且也学过编号为"02"的课程的同学的信息.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+---------------------+------+
| SID  | Sname | Sage                | Ssex |
+------+-------+---------------------+------+
| 01   | 赵雷  | 1990-01-01 00:00:00 | 男   |
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   |
| 05   | 周梅  | 1991-12-01 00:00:00 | 女   |
+------+-------+---------------------+------+
5 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- 1
</span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> Student.<span style=color:#f92672>*</span>
<span style=color:#66d9ef>from</span> Student,SC
<span style=color:#66d9ef>where</span> Student.SID<span style=color:#f92672>=</span>SC.SID <span style=color:#66d9ef>and</span> SC.CID<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;01&#39;</span>
<span style=color:#66d9ef>and</span> <span style=color:#66d9ef>exists</span>
(
    <span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> SC sc_2 <span style=color:#66d9ef>where</span> sc_2.CID<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;02&#39;</span> <span style=color:#66d9ef>and</span> sc_2.SID<span style=color:#f92672>=</span>SC.SID
)
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> Student.SID;
<span style=color:#75715e>-- 2
</span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> s.<span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> Student s <span style=color:#66d9ef>where</span> s.SID <span style=color:#66d9ef>in</span>
(
    <span style=color:#66d9ef>select</span> SID <span style=color:#66d9ef>from</span>
    (
        <span style=color:#66d9ef>select</span> SID <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> SC.CID<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;01&#39;</span>
        <span style=color:#66d9ef>union</span> <span style=color:#66d9ef>all</span>
        <span style=color:#66d9ef>select</span> SID <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> SC.CID<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;02&#39;</span>
    ) t <span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> SID <span style=color:#66d9ef>having</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
)
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> s.SID;
</code></pre></div><ol start=8><li>查询没有学全所有课程的同学的信息.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+---------------------+------+
| SID  | Sname | Sage                | Ssex |
+------+-------+---------------------+------+
| 05   | 周梅  | 1991-12-01 00:00:00 | 女   |
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   |
| 07   | 郑竹  | 1989-07-01 00:00:00 | 女   |
+------+-------+---------------------+------+
3 rows in set (0.01 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- 1
</span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> Student.<span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> Student,SC
<span style=color:#66d9ef>where</span> Student.SID<span style=color:#f92672>=</span>SC.SID 
<span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> Student.SID,Student.Sname,Student.Sage,Student.Ssex <span style=color:#66d9ef>having</span> <span style=color:#66d9ef>count</span>(CID) <span style=color:#f92672>&lt;</span> (<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(CID) <span style=color:#66d9ef>from</span> Course);
<span style=color:#75715e>-- 2
</span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> Student.<span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> Student
<span style=color:#66d9ef>left</span> <span style=color:#66d9ef>join</span> SC <span style=color:#66d9ef>on</span> Student.SID<span style=color:#f92672>=</span>SC.SID
<span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> Student.SID,Student.Sname,Student.Sage,Student.Ssex <span style=color:#66d9ef>having</span> <span style=color:#66d9ef>count</span>(CID)<span style=color:#f92672>&lt;</span>(<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(CID) <span style=color:#66d9ef>from</span> Course);

<span style=color:#66d9ef>select</span> <span style=color:#f92672>*</span>
<span style=color:#66d9ef>from</span> Student
<span style=color:#66d9ef>left</span> <span style=color:#66d9ef>join</span> SC <span style=color:#66d9ef>on</span> Student.SID<span style=color:#f92672>=</span>SC.SID
<span style=color:#66d9ef>left</span> <span style=color:#66d9ef>join</span> Course <span style=color:#66d9ef>on</span> SC.CID<span style=color:#f92672>=</span>Course.CID
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> Student.SID;
</code></pre></div><ol start=9><li>查询至少有一门课与学号为"01"的同学所学相同的同学的信息.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+---------------------+------+
| SID  | Sname | Sage                | Ssex |
+------+-------+---------------------+------+
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   |
| 05   | 周梅  | 1991-12-01 00:00:00 | 女   |
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   |
| 07   | 郑竹  | 1989-07-01 00:00:00 | 女   |
+------+-------+---------------------+------+
6 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> <span style=color:#66d9ef>distinct</span> Student.<span style=color:#f92672>*</span>
<span style=color:#66d9ef>from</span> Student, SC
<span style=color:#66d9ef>where</span> Student.SID<span style=color:#f92672>=</span>SC.SID <span style=color:#66d9ef>and</span> SC.CID <span style=color:#66d9ef>in</span>
(
    <span style=color:#66d9ef>select</span> CID <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> SC.SID<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;01&#39;</span>
) <span style=color:#66d9ef>and</span> Student.SID<span style=color:#f92672>!=</span><span style=color:#e6db74>&#39;01&#39;</span>;
</code></pre></div><ol start=10><li>查询没学过"张三"老师讲授的任一门课程的学生姓名.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+
| SID  | Sname |
+------+-------+
| 06   | 吴兰  |
| 08   | 王菊  |
+------+-------+
2 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> Student.SID,Student.Sname <span style=color:#66d9ef>from</span> Student <span style=color:#66d9ef>where</span> Student.SID <span style=color:#66d9ef>not</span> <span style=color:#66d9ef>in</span>
(
    <span style=color:#66d9ef>select</span> <span style=color:#66d9ef>distinct</span> SC.SID <span style=color:#66d9ef>from</span> SC,Course,Teacher <span style=color:#66d9ef>where</span> SC.CID<span style=color:#f92672>=</span>Course.CID <span style=color:#66d9ef>and</span> Course.TID<span style=color:#f92672>=</span>Teacher.TID <span style=color:#66d9ef>and</span> Teacher.Tname<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;张三&#34;</span>
)
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> Student.SID;
</code></pre></div><ol start=11><li>查询和"01"号的同学学习的课程完全相同的其他同学的信息.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+---------------------+------+
| SID  | Sname | Sage                | Ssex |
+------+-------+---------------------+------+
| 02   | 钱电  | 1990-12-21 00:00:00 | 男   |
| 03   | 孙风  | 1990-05-20 00:00:00 | 男   |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   |
+------+-------+---------------------+------+
3 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- 这个只是按数量算...
</span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> Student.<span style=color:#f92672>*</span> <span style=color:#66d9ef>from</span> Student <span style=color:#66d9ef>where</span> SID <span style=color:#66d9ef>in</span>
(
    <span style=color:#66d9ef>select</span> <span style=color:#66d9ef>distinct</span> SC.SID <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> SID<span style=color:#f92672>!=</span><span style=color:#e6db74>&#39;01&#39;</span> <span style=color:#66d9ef>and</span> SC.CID <span style=color:#66d9ef>in</span>
    (
        <span style=color:#66d9ef>select</span> <span style=color:#66d9ef>distinct</span> CID <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> SID<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;01&#39;</span>
    ) <span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> SC.SID <span style=color:#66d9ef>having</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>)<span style=color:#f92672>=</span>(<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> SID<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;01&#39;</span>)
);
</code></pre></div><ol start=12><li>查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+-----------+
| SID  | Sname | avg_score |
+------+-------+-----------+
| 04   | 李云  |     33.33 |
| 06   | 吴兰  |     32.50 |
+------+-------+-----------+
2 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- group by(分组)having(条件) 用法.
</span><span style=color:#75715e>--  select Ssex from Student group by Ssex having Ssex!=&#39;男&#39;;
</span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> SID <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> score <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>60</span>
<span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> SID <span style=color:#66d9ef>having</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>2</span>

<span style=color:#66d9ef>select</span> Student.SID, Student.Sname, <span style=color:#66d9ef>cast</span>(<span style=color:#66d9ef>avg</span>(score) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>2</span>)) avg_score <span style=color:#66d9ef>from</span> Student, SC
<span style=color:#66d9ef>where</span> Student.SID<span style=color:#f92672>=</span>SC.SID <span style=color:#66d9ef>and</span> Student.SID <span style=color:#66d9ef>in</span>
(
    <span style=color:#66d9ef>select</span> SID <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> score<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>60</span>
    <span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> SID <span style=color:#66d9ef>having</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>)<span style=color:#f92672>&gt;=</span><span style=color:#ae81ff>2</span>
)
<span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> Student.SID,Student.Sname;
</code></pre></div><ol start=13><li>检索"01"课程分数小于60，按分数降序排列的学生信息.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+-------+---------------------+------+-------+------+
| SID  | Sname | Sage                | Ssex | score | CID  |
+------+-------+---------------------+------+-------+------+
| 04   | 李云  | 1990-08-06 00:00:00 | 男   |  50.0 | 01   |
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   |  34.0 | 03   |
| 06   | 吴兰  | 1992-03-01 00:00:00 | 女   |  31.0 | 01   |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   |  30.0 | 02   |
| 04   | 李云  | 1990-08-06 00:00:00 | 男   |  20.0 | 03   |
+------+-------+---------------------+------+-------+------+
5 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>select</span> <span style=color:#66d9ef>distinct</span> Student.<span style=color:#f92672>*</span>,SC.score,Course.CID <span style=color:#66d9ef>from</span> Student,SC,Course <span style=color:#66d9ef>where</span> Student.SID<span style=color:#f92672>=</span>SC.SID <span style=color:#66d9ef>and</span> SC.CID<span style=color:#f92672>=</span>Course.CID <span style=color:#66d9ef>and</span> Student.SID <span style=color:#66d9ef>in</span> 
(
    <span style=color:#66d9ef>select</span> SID <span style=color:#66d9ef>from</span> SC,Course <span style=color:#66d9ef>where</span> SC.CID<span style=color:#f92672>=</span>Course.CID <span style=color:#66d9ef>and</span> SC.score<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>60</span> <span style=color:#66d9ef>and</span> Course.CID<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;01&#39;</span>
)
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> SC.score <span style=color:#66d9ef>desc</span>;

</code></pre></div><ol start=14><li>按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+------+------+------+------+------+--------+
| 学号 | 姓名 | 语文 | 数学 | 英语 | 平均分 |
+------+------+------+------+------+--------+
| 07   | 郑竹 | NULL | 89.0 | 98.0 |  93.50 |
| 01   | 赵雷 | 80.0 | 90.0 | 99.0 |  89.67 |
| 05   | 周梅 | 76.0 | 87.0 | NULL |  81.50 |
| 03   | 孙风 | 80.0 | 80.0 | 80.0 |  80.00 |
| 02   | 钱电 | 70.0 | 60.0 | 80.0 |  70.00 |
| 04   | 李云 | 50.0 | 30.0 | 20.0 |  33.33 |
| 06   | 吴兰 | 31.0 | NULL | 34.0 |  32.50 |
| 08   | 王菊 | NULL | NULL | NULL |   NULL |
+------+------+------+------+------+--------+
8 rows in set (0.00 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- 列转行
</span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> a.SID <span style=color:#960050;background-color:#1e0010>学号</span>,a.Sname <span style=color:#960050;background-color:#1e0010>姓名</span>,
<span style=color:#66d9ef>max</span>(<span style=color:#66d9ef>case</span> <span style=color:#66d9ef>c</span>.Cname <span style=color:#66d9ef>when</span> <span style=color:#e6db74>&#39;语文&#39;</span> <span style=color:#66d9ef>then</span> b.score <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>end</span>) <span style=color:#960050;background-color:#1e0010>语文</span>,
<span style=color:#66d9ef>max</span>(<span style=color:#66d9ef>case</span> <span style=color:#66d9ef>c</span>.Cname <span style=color:#66d9ef>when</span> <span style=color:#e6db74>&#39;数学&#39;</span> <span style=color:#66d9ef>then</span> b.score <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>end</span>) <span style=color:#960050;background-color:#1e0010>数学</span>,
<span style=color:#66d9ef>max</span>(<span style=color:#66d9ef>case</span> <span style=color:#66d9ef>c</span>.Cname <span style=color:#66d9ef>when</span> <span style=color:#e6db74>&#39;英语&#39;</span> <span style=color:#66d9ef>then</span> b.score <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>null</span> <span style=color:#66d9ef>end</span>) <span style=color:#960050;background-color:#1e0010>英语</span>,
<span style=color:#66d9ef>cast</span>(<span style=color:#66d9ef>avg</span>(b.score) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>18</span>, <span style=color:#ae81ff>2</span>)) <span style=color:#960050;background-color:#1e0010>平均分</span>
<span style=color:#66d9ef>from</span> student a
<span style=color:#66d9ef>left</span> <span style=color:#66d9ef>join</span> SC b <span style=color:#66d9ef>on</span> a.SID<span style=color:#f92672>=</span>b.SID
<span style=color:#66d9ef>left</span> <span style=color:#66d9ef>join</span> Course <span style=color:#66d9ef>c</span> <span style=color:#66d9ef>on</span> b.CID<span style=color:#f92672>=</span><span style=color:#66d9ef>c</span>.CID
<span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> a.SID, a.Sname
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> <span style=color:#960050;background-color:#1e0010>平均分</span> <span style=color:#66d9ef>desc</span>;
</code></pre></div><ol start=15><li>查询各科成绩最高分、最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率
&ndash;及格为>=60，中等为：70-80，优良为：80-90，优秀为：>=90.
结果:</li></ol><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>+----------+----------+--------+--------+--------+--------+--------+--------+--------+
| 课程编号 | 课程名称 | 最高分 | 最低分 | 平均分 | 及格率 | 中等率 | 优良率 | 优秀率 |
+----------+----------+--------+--------+--------+--------+--------+--------+--------+
| 01       | 语文     |   80.0 |   31.0 |  64.50 |  66.67 |  33.33 |  33.33 |   0.00 |
| 02       | 数学     |   90.0 |   30.0 |  72.67 |  83.33 |   0.00 |  50.00 |  16.67 |
| 03       | 英语     |   99.0 |   20.0 |  68.50 |  66.67 |   0.00 |  33.33 |  33.33 |
+----------+----------+--------+--------+--------+--------+--------+--------+--------+
3 rows in set (0.07 sec)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#75715e>-- 1
</span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> m.CID <span style=color:#960050;background-color:#1e0010>课程编号</span>,m.Cname <span style=color:#960050;background-color:#1e0010>课程名称</span>,<span style=color:#66d9ef>max</span>(n.score) <span style=color:#960050;background-color:#1e0010>最高分</span>,<span style=color:#66d9ef>min</span>(n.score) <span style=color:#960050;background-color:#1e0010>最低分</span>,
<span style=color:#66d9ef>cast</span>(<span style=color:#66d9ef>avg</span>(n.score) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>18</span>,<span style=color:#ae81ff>2</span>)) <span style=color:#960050;background-color:#1e0010>平均分</span>,
<span style=color:#66d9ef>cast</span>((<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> sc <span style=color:#66d9ef>where</span> CID<span style=color:#f92672>=</span>m.CID <span style=color:#66d9ef>and</span> score<span style=color:#f92672>&gt;=</span><span style=color:#ae81ff>60</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span>.<span style=color:#ae81ff>0</span><span style=color:#f92672>/</span>(<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> sc <span style=color:#66d9ef>where</span> CID<span style=color:#f92672>=</span>m.CID) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>18</span>, <span style=color:#ae81ff>2</span>)) <span style=color:#960050;background-color:#1e0010>及格率</span>,
<span style=color:#66d9ef>cast</span>((<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> sc <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID <span style=color:#66d9ef>and</span> score <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>70</span> <span style=color:#66d9ef>and</span> score <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>80</span> )<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span>.<span style=color:#ae81ff>0</span> <span style=color:#f92672>/</span> (<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> sc <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>18</span>,<span style=color:#ae81ff>2</span>))  <span style=color:#960050;background-color:#1e0010>中等率</span> ,
<span style=color:#66d9ef>cast</span>((<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> sc <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID <span style=color:#66d9ef>and</span> score <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>80</span> <span style=color:#66d9ef>and</span> score <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>90</span> )<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span>.<span style=color:#ae81ff>0</span> <span style=color:#f92672>/</span> (<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> sc <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>18</span>,<span style=color:#ae81ff>2</span>))  <span style=color:#960050;background-color:#1e0010>优良率</span> ,
<span style=color:#66d9ef>cast</span>((<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> sc <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID <span style=color:#66d9ef>and</span> score <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>90</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span>.<span style=color:#ae81ff>0</span> <span style=color:#f92672>/</span> (<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> sc <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>18</span>,<span style=color:#ae81ff>2</span>))  <span style=color:#960050;background-color:#1e0010>优秀率</span> 
<span style=color:#66d9ef>from</span> course m,sc n
<span style=color:#66d9ef>where</span> m.CID<span style=color:#f92672>=</span>n.CID
<span style=color:#66d9ef>group</span> <span style=color:#66d9ef>by</span> m.CID,m.Cname
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> m.CID;
<span style=color:#75715e>-- 2
</span><span style=color:#75715e></span><span style=color:#66d9ef>select</span> m.CID  <span style=color:#960050;background-color:#1e0010>课程编号</span> , m.Cname  <span style=color:#960050;background-color:#1e0010>课程名称</span> , 
(<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>max</span>(score) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID)  <span style=color:#960050;background-color:#1e0010>最高分</span> ,
(<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>min</span>(score) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID)  <span style=color:#960050;background-color:#1e0010>最低分</span> ,
(<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>cast</span>(<span style=color:#66d9ef>avg</span>(score) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>18</span>,<span style=color:#ae81ff>2</span>)) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID)  <span style=color:#960050;background-color:#1e0010>平均分</span> ,
<span style=color:#66d9ef>cast</span>((<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID <span style=color:#66d9ef>and</span> score <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>60</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span>.<span style=color:#ae81ff>0</span> <span style=color:#f92672>/</span> (<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>18</span>,<span style=color:#ae81ff>2</span>))  <span style=color:#960050;background-color:#1e0010>及格率</span>,
<span style=color:#66d9ef>cast</span>((<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID <span style=color:#66d9ef>and</span> score <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>70</span> <span style=color:#66d9ef>and</span> score <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>80</span> )<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span>.<span style=color:#ae81ff>0</span> <span style=color:#f92672>/</span> (<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>18</span>,<span style=color:#ae81ff>2</span>))  <span style=color:#960050;background-color:#1e0010>中等率</span> ,
<span style=color:#66d9ef>cast</span>((<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID <span style=color:#66d9ef>and</span> score <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>80</span> <span style=color:#66d9ef>and</span> score <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>90</span> )<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span>.<span style=color:#ae81ff>0</span> <span style=color:#f92672>/</span> (<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>18</span>,<span style=color:#ae81ff>2</span>))  <span style=color:#960050;background-color:#1e0010>优良率</span> ,
<span style=color:#66d9ef>cast</span>((<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID <span style=color:#66d9ef>and</span> score <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>90</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span>.<span style=color:#ae81ff>0</span> <span style=color:#f92672>/</span> (<span style=color:#66d9ef>select</span> <span style=color:#66d9ef>count</span>(<span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>from</span> SC <span style=color:#66d9ef>where</span> CID <span style=color:#f92672>=</span> m.CID) <span style=color:#66d9ef>as</span> decimal(<span style=color:#ae81ff>18</span>,<span style=color:#ae81ff>2</span>))  <span style=color:#960050;background-color:#1e0010>优秀率</span>
<span style=color:#66d9ef>from</span> Course m 
<span style=color:#66d9ef>order</span> <span style=color:#66d9ef>by</span> m.CID;
</code></pre></div><hr><p>我实在是太难了&mldr;&mldr;&mldr;&mldr;
16. 按各科成绩进行排序，并显示排名.</p><ul><li>Score重复时保留名次空缺.
结果:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt>--- emmm
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>
</code></pre></div><ul><li>Score重复时合并名次(DENSE_RANK完成).
结果:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt></code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>
</code></pre></div><ol start=17><li>查询学生的总成绩并进行排名.</li></ol><ul><li>查询学生的总成绩.
结果:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt></code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql></code></pre></div><ul><li>查询学生的总成绩并进行排名，sql 2000用子查询完成，分总分重复时保留名次空缺和不保留名次空缺两种。
结果:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt></code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql></code></pre></div><ul><li>查询学生的总成绩并进行排名，sql 2005用rank,DENSE_RANK完成，分总分重复时保留名次空缺和不保留名次空缺两种。
结果:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt></code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>
</code></pre></div><p>未完待续~</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://razielez.github.io/tags/sql/>SQL</a></li></ul><nav class=paginav><a class=prev href=https://razielez.github.io/posts/%E4%B8%80%E6%AC%A1%E5%AF%B9idea%E7%9A%84%E8%B0%83%E4%BC%98/><span class=title>« Prev Page</span><br><span>对IDEA调优</span></a>
<a class=next href=https://razielez.github.io/posts/java%E7%BA%BF%E7%A8%8B%E6%A3%80%E6%B5%8B%E6%AD%BB%E9%94%81/><span class=title>Next Page »</span><br><span>Java线程检测死锁</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share SQL练习题 on twitter" href="https://twitter.com/intent/tweet/?text=SQL%e7%bb%83%e4%b9%a0%e9%a2%98&url=https%3a%2f%2frazielez.github.io%2fposts%2f%25E5%2587%25A0%25E9%2581%2593sql%25E7%25BB%2583%25E4%25B9%25A0%25E9%25A2%2598%2f&hashtags=SQL"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share SQL练习题 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2frazielez.github.io%2fposts%2f%25E5%2587%25A0%25E9%2581%2593sql%25E7%25BB%2583%25E4%25B9%25A0%25E9%25A2%2598%2f&title=SQL%e7%bb%83%e4%b9%a0%e9%a2%98&summary=SQL%e7%bb%83%e4%b9%a0%e9%a2%98&source=https%3a%2f%2frazielez.github.io%2fposts%2f%25E5%2587%25A0%25E9%2581%2593sql%25E7%25BB%2583%25E4%25B9%25A0%25E9%25A2%2598%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share SQL练习题 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2frazielez.github.io%2fposts%2f%25E5%2587%25A0%25E9%2581%2593sql%25E7%25BB%2583%25E4%25B9%25A0%25E9%25A2%2598%2f&title=SQL%e7%bb%83%e4%b9%a0%e9%a2%98"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share SQL练习题 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2frazielez.github.io%2fposts%2f%25E5%2587%25A0%25E9%2581%2593sql%25E7%25BB%2583%25E4%25B9%25A0%25E9%25A2%2598%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share SQL练习题 on whatsapp" href="https://api.whatsapp.com/send?text=SQL%e7%bb%83%e4%b9%a0%e9%a2%98%20-%20https%3a%2f%2frazielez.github.io%2fposts%2f%25E5%2587%25A0%25E9%2581%2593sql%25E7%25BB%2583%25E4%25B9%25A0%25E9%25A2%2598%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share SQL练习题 on telegram" href="https://telegram.me/share/url?text=SQL%e7%bb%83%e4%b9%a0%e9%a2%98&url=https%3a%2f%2frazielez.github.io%2fposts%2f%25E5%2587%25A0%25E9%2581%2593sql%25E7%25BB%2583%25E4%25B9%25A0%25E9%25A2%2598%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://razielez.github.io>Razielez's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script></body></html>